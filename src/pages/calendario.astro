---
import Layout from "../layouts/Layout.astro";
import CalendarView from "../components/CalendarView";
import "../styles/variables.css"
---

<Layout title="">
        <main class="container mx-auto px-4 py-6">
                <CalendarView client:load />
        </main>
</Layout>

<script is:inline>
  (function () {
    const io = new IntersectionObserver(
      (entries, obs) => {
        entries.forEach((e) => {
          if (e.isIntersecting) {
            e.target.classList.add("in");
            obs.unobserve(e.target);
          }
        });
      },
      { threshold: 0.1, rootMargin: "0px 0px -10% 0px" }
    );

    function observeReveals() {
      document.querySelectorAll("[data-reveal], .react-calendar__tile").forEach((el, i) => {
        if (el.classList.contains('react-calendar__tile')) {
          el.style.setProperty("--delay", `${Math.min(i, 24) * 18}ms`);
          el.classList.add("reveal-tile");
        }
        io.observe(el);
      });
    }

    function wireNav() {
      const nav = document.querySelector(".react-calendar__navigation");
      if (nav && !nav.dataset._wired) {
        nav.dataset._wired = "1";
        nav.addEventListener("click", () => setTimeout(observeReveals, 0));
      }
    }

    function ready() {
      observeReveals();
      wireNav();
    }

    if (document.readyState !== "loading") ready();
    else document.addEventListener("DOMContentLoaded", ready);
  })();
</script>

<style is:global>
        /* Estilos personalizados para el calendario */

        /* Remover cualquier color verde predeterminado */
        .react-calendar__tile--now {
                background: #eff6ff !important;
                color: #1e40af !important;
                font-weight: 600;
        }

        .react-calendar__tile--now:enabled:hover,
        .react-calendar__tile--now:enabled:focus {
                background: #dbeafe !important;
        }

        /* Día seleccionado/activo - AZUL */
        .react-calendar__tile--active,
        .react-calendar__tile--active:enabled:hover,
        .react-calendar__tile--active:enabled:focus {
                background: linear-gradient(
                        135deg,
                        #2563eb 0%,
                        #1d4ed8 100%
                ) !important;
                color: white !important;
                border-radius: 0.25rem !important;
                box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.3) !important;
        }

        /* Días con eventos */
        .has-event {
                background: linear-gradient(
                        135deg,
                        #dbeafe 0%,
                        #bfdbfe 100%
                ) !important;
                color: #1e40af !important;
                font-weight: bold;
                position: relative;
                border: 1px solid #93c5fd !important;
        }

        .has-event-period {
                position: relative;
                font-weight: 600;
        }

  .react-calendar {
    width: 100% !important;
    max-width: 840px !important;
    margin-inline: auto;
    background: var(--card);
    border: 0;
    border-radius: 1rem;
    font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    box-shadow: var(--shadow);
    overflow: hidden;
  }

  .react-calendar__navigation {
    margin-bottom: 0.25rem;
    gap: 0.375rem;
    display: grid;
    grid-template-columns: repeat(5, minmax(0, 1fr));
    align-items: center;
    padding: 0.625rem;
    background: linear-gradient(0deg, rgba(204, 246, 228, 0.28), rgba(204, 246, 228, 0.12));
  }

  .react-calendar__navigation button {
    font-size: 1.05rem;
    color: var(--accent-ink);
    transition: transform 140ms ease, background-color 180ms ease, box-shadow 180ms ease;
    border-radius: 0.75rem;
    min-width: 44px;
    background: white;
    padding: 0.5rem 0.6rem;
    border: 0;
  }
  .react-calendar__navigation button:enabled:hover,
  .react-calendar__navigation button:enabled:focus-visible {
    background-color: var(--accent-200);
    box-shadow: 0 6px 16px rgba(15, 62, 47, 0.08);
    outline: none;
    transform: translateY(-1px);
  }
  .react-calendar__navigation__label { font-weight: 800; letter-spacing: .2px; color: var(--accent-ink); }

  .react-calendar__month-view__weekdays {
    font-size: .9rem;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--accent-ink);
    background: linear-gradient(180deg, rgba(204, 246, 228, 0.38), white);
  }
  .react-calendar__month-view__weekdays abbr { text-decoration: none; cursor: default; }

        .react-calendar__tile {
                padding: 1em 0.5em;
                position: relative;
        }

        .react-calendar__tile:enabled:hover,
        .react-calendar__tile:enabled:focus {
                background-color: #eff6ff !important;
                border-radius: 0.25rem;
        }

        /* Hover especial para fechas con eventos */
        .has-event:enabled:hover,
        .has-event:enabled:focus {
                background: linear-gradient(
                        135deg,
                        #bfdbfe 0%,
                        #93c5fd 100%
                ) !important;
                transform: scale(1.05);
                transition: all 0.2s ease;
        }

        .calendar-container {
                background-color: #f8fafc;
                border-radius: 1rem;
                padding: 2rem;
        }

        /* Estilos para la navegación del calendario (mes/año) */
        .react-calendar__navigation {
                background: linear-gradient(
                        135deg,
                        #1e40af 0%,
                        #2563eb 100%
                ) !important;
                border-radius: 0.5rem 0.5rem 0 0;
                padding: 0.5rem;
                margin-bottom: 0;
        }

        .react-calendar__navigation button {
                color: white !important;
                font-weight: 600;
                font-size: 1rem;
                min-width: 44px;
                background: white;
        }

        .react-calendar__navigation button:enabled:hover,
        .react-calendar__navigation button:enabled:focus {
                background-color: rgba(255, 255, 255, 0.2) !important;
                border-radius: 0.25rem;
        }

        .react-calendar__navigation button:disabled {
                opacity: 0.5;
        }

        .react-calendar__navigation__label__labelText {
                font-weight: 700;
                text-transform: capitalize;
        }

        /* Estilos para vista de año y década */
        .react-calendar__year-view .react-calendar__tile,
        .react-calendar__decade-view .react-calendar__tile,
        .react-calendar__century-view .react-calendar__tile {
                padding: 1.5em 0.5em;
        }

        /* Personalización de la barra de scroll */
        ::-webkit-scrollbar {
                width: 10px;
                height: 10px;
        }

        ::-webkit-scrollbar-track {
                background: #eff6ff;
                border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                border-radius: 10px;
                border: 2px solid #eff6ff;
        }

        ::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        }

        /* Firefox */
        * {
                scrollbar-width: thin;
                scrollbar-color: #3b82f6 #eff6ff;
        }
</style>