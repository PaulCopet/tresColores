---
import Layout from "../layouts/Layout.astro";
import CalendarView from "../components/CalendarView";
import "../styles/variables.css";
---

<Layout title="">
        <main class="container mx-auto px-4 py-6">
                <CalendarView client:load />
        </main>
</Layout>

<script is:inline>
        (function () {
                const io = new IntersectionObserver(
                        (entries, obs) => {
                                entries.forEach((e) => {
                                        if (e.isIntersecting) {
                                                e.target.classList.add("in");
                                                obs.unobserve(e.target);
                                        }
                                });
                        },
                        { threshold: 0.1, rootMargin: "0px 0px -10% 0px" },
                );

                function observeReveals() {
                        document.querySelectorAll(
                                "[data-reveal], .react-calendar__tile",
                        ).forEach((el, i) => {
                                if (
                                        el.classList.contains(
                                                "react-calendar__tile",
                                        )
                                ) {
                                        el.style.setProperty(
                                                "--delay",
                                                `${Math.min(i, 24) * 18}ms`,
                                        );
                                        el.classList.add("reveal-tile");
                                }
                                io.observe(el);
                        });
                }

                function wireNav() {
                        const nav = document.querySelector(
                                ".react-calendar__navigation",
                        );
                        if (nav && !nav.dataset._wired) {
                                nav.dataset._wired = "1";
                                nav.addEventListener("click", () =>
                                        setTimeout(observeReveals, 0),
                                );
                        }
                }

                function ready() {
                        observeReveals();
                        wireNav();
                }

                if (document.readyState !== "loading") ready();
                else document.addEventListener("DOMContentLoaded", ready);
        })();
</script>

<style is:global>
        /* Estilos personalizados para el calendario */

        /* Día actual - MODERNO */
        .react-calendar__tile--now {
                background: linear-gradient(
                        135deg,
                        #fbbf24 0%,
                        #f59e0b 100%
                ) !important;
                color: white !important;
                font-weight: 700;
                border: 2px solid #d97706 !important;
                box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3) !important;
        }

        .react-calendar__tile--now:enabled:hover,
        .react-calendar__tile--now:enabled:focus {
                background: linear-gradient(
                        135deg,
                        #f59e0b 0%,
                        #d97706 100%
                ) !important;
                transform: scale(1.05) !important;
                box-shadow: 0 6px 16px rgba(251, 191, 36, 0.4) !important;
        }

        /* Día seleccionado/activo - AZUL MÁS TENUE */
        .react-calendar__tile--active,
        .react-calendar__tile--active:enabled:hover,
        .react-calendar__tile--active:enabled:focus {
                background: linear-gradient(
                        135deg,
                        rgba(37, 99, 235, 0.15) 0%,
                        rgba(29, 78, 216, 0.25) 100%
                ) !important;
                color: #1e40af !important;
                border: 2px solid #93c5fd !important;
                border-radius: 0.5rem !important;
                box-shadow: 0 2px 8px rgba(37, 99, 235, 0.2) !important;
                font-weight: 600 !important;
        }

        /* Días con eventos */
        .has-event {
                background: linear-gradient(
                        135deg,
                        #3b82f6 0%,
                        #2563eb 100%
                ) !important;
                color: white !important;
                font-weight: 700;
                position: relative;
                border: 2px solid #1d4ed8 !important;
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3) !important;
                transform: scale(1.02);
        }

        /* Indicador pequeño para días con eventos */
        .has-event::after {
                content: "";
                position: absolute;
                top: 0.5rem;
                right: 0.5rem;
                width: 8px;
                height: 8px;
                background: #fbbf24;
                border-radius: 50%;
                border: 1px solid white;
        }

        .has-event-period {
                position: relative;
                font-weight: 600;
        }

        /* Día seleccionado que TAMBIÉN tiene eventos - RESALTADO ESPECIAL */
        .react-calendar__tile--active.has-event,
        .react-calendar__tile--active.has-event:enabled:hover,
        .react-calendar__tile--active.has-event:enabled:focus {
                background: linear-gradient(
                        135deg,
                        #7c3aed 0%,
                        #6366f1 100%
                ) !important;
                color: white !important;
                border: 3px solid #a855f7 !important;
                box-shadow: 0 6px 16px rgba(124, 58, 237, 0.4) !important;
                transform: scale(1.1) !important;
                animation: pulse-ring 2s infinite !important;
        }

        @keyframes pulse-ring {
                0% {
                        box-shadow: 0 6px 16px rgba(124, 58, 237, 0.4);
                }
                50% {
                        box-shadow: 0 8px 20px rgba(124, 58, 237, 0.6);
                }
                100% {
                        box-shadow: 0 6px 16px rgba(124, 58, 237, 0.4);
                }
        }

        /* Estilos generales del calendario */
        .react-calendar {
                width: 100% !important;
                max-width: 900px !important;
                margin-inline: auto;
                background: white;
                border: 0;
                border-radius: 1rem;
                box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
                overflow: hidden;
                backdrop-filter: blur(10px);
                min-height: 520px;
        }
        /* Navegación del calendario */
        .react-calendar__navigation {
                gap: 0.75rem;
                display: flex !important;
                justify-content: space-between;
                align-items: center;
                padding: 1rem;
                background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                border-bottom: 1px solid #e2e8f0;
        }

        .react-calendar__navigation button {
                font-size: 1rem;
                color: #2c5ca0;
                transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
                border-radius: 0.5rem;
                width: 44px;
                height: 44px;
                background: white;
                padding: 0;
                border: 1px solid #e2e8f0;
                font-weight: 600;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0;
                flex-shrink: 0;
        }

        .react-calendar__navigation button:enabled:hover,
        .react-calendar__navigation button:enabled:focus-visible {
                background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                color: white;
                border-color: #2563eb;
                box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
                outline: none;
                transform: translateY(-1px) scale(1.02);
        }

        .react-calendar__navigation button:disabled {
                opacity: 0.4;
                cursor: not-allowed;
                background: #f8fafc;
                color: #94a3b8;
        }

        /* Botones de navegación anterior/siguiente */
        .react-calendar__navigation__arrow {
                font-size: 1.2rem !important;
                font-weight: 700 !important;
        }

        .react-calendar__navigation__prev-button,
        .react-calendar__navigation__next-button {
                background: linear-gradient(
                        135deg,
                        #e2e8f0 0%,
                        #f1f5f9 100%
                ) !important;
                border: 1px solid #cbd5e1 !important;
        }

        .react-calendar__navigation__prev-button:enabled:hover,
        .react-calendar__navigation__next-button:enabled:hover {
                background: linear-gradient(
                        135deg,
                        #ef4444 0%,
                        #dc2626 100%
                ) !important;
                color: white !important;
                border-color: #dc2626 !important;
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;
        }
        .react-calendar__navigation__label {
                font-weight: 700;
                letter-spacing: 0.5px;
                color: #1e293b;
                font-size: 1.1rem;
                text-transform: capitalize;
        }

        .react-calendar__navigation__label:hover {
                background: linear-gradient(
                        135deg,
                        #6366f1 0%,
                        #8b5cf6 100%
                ) !important;
                color: white !important;
        }

        /* Organización específica de botones de navegación */
        .react-calendar__navigation__prev-button {
                order: 1;
        }

        .react-calendar__navigation__prev2-button {
                order: 2;
        }

        .react-calendar__navigation__label {
                order: 3;
                flex: 1;
                text-align: center;
                margin: 0 1rem;
        }

        .react-calendar__navigation__next2-button {
                order: 4;
        }

        .react-calendar__navigation__next-button {
                order: 5;
        }

        .react-calendar__month-view__weekdays {
                font-size: 0.8rem;
                font-weight: 600;
                text-transform: uppercase;
                color: #475569;
                background: linear-gradient(
                        180deg,
                        rgba(248, 250, 252, 0.8),
                        white
                );
                padding: 0.5rem 0;
                margin-bottom: -0.5rem;
        }

        .react-calendar__month-view__weekdays__weekday {
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 10px;
        }

        .react-calendar__month-view__weekdays abbr {
                text-decoration: none;
                cursor: default;
        }

        .react-calendar__tile {
                padding: 0;
                position: relative;
                border-radius: 0.75rem !important;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
                font-weight: 500;
                min-height: 70px;
                height: 70px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1rem;
        }

        .react-calendar__tile:enabled:hover,
        .react-calendar__tile:enabled:focus {
                background-color: #f1f5f9 !important;
                transform: translateY(-2px) !important;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
        }

        /* Hover especial para fechas con eventos */
        .has-event:enabled:hover,
        .has-event:enabled:focus {
                background: linear-gradient(
                        135deg,
                        #1e40af 0%,
                        #1d4ed8 100%
                ) !important;
                color: white !important;
                transform: scale(1.08) !important;
                box-shadow: 0 8px 20px rgba(59, 130, 246, 0.5) !important;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        .calendar-container {
                background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                border-radius: 1.5rem;
                padding: 2.5rem;
                box-shadow:
                        0 20px 25px -5px rgba(0, 0, 0, 0.1),
                        0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        /* Estilos para la navegación del calendario (mes/año) */
        .react-calendar__navigation {
                border-radius: 0.5rem 0.5rem 0 0;
                padding: 2rem;
                margin-bottom: 0;
        }

        .react-calendar__navigation button {
                color: rgb(0, 0, 0) !important;
                font-weight: 600;
                font-size: 1rem;
                min-width: 44px;
                background: white;
        }

        .react-calendar__navigation button:enabled:hover,
        .react-calendar__navigation button:enabled:focus {
                background-color: rgba(255, 255, 255, 0.2) !important;
                border-radius: 0.25rem;
        }

        .react-calendar__navigation button:disabled {
                opacity: 0.5;
        }

        .react-calendar__navigation__label__labelText {
                font-weight: 700;
                text-transform: capitalize;
        }

        /* Estilos para vista de año y década */
        .react-calendar__year-view .react-calendar__tile,
        .react-calendar__decade-view .react-calendar__tile,
        .react-calendar__century-view .react-calendar__tile {
                padding: 1.5em 0.5em;
        }

        /* Personalización de la barra de scroll */
        ::-webkit-scrollbar {
                width: 10px;
                height: 10px;
        }

        ::-webkit-scrollbar-track {
                background: #eff6ff;
                border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
                background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                border-radius: 10px;
                border: 2px solid #eff6ff;
        }

        ::-webkit-scrollbar-thumb:hover {
                background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
        }

        /* Firefox */
        * {
                scrollbar-width: thin;
                scrollbar-color: #3b82f6 #eff6ff;
        }
</style>
